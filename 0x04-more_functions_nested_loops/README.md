 more functions and nedted loops.
